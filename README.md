# ClusterManager
## Запуск ##

### Необходимо для запуска ###

```
#!bash

# tornado
pip3 install tornado

# requests
pip3 install requests


```



### Master: ###
```
#!bash
python3 master.py (-c [--config]) (файл конфига)

```
### Agent: ###
```
#!bash
python3 agent.py -n[--name] (имя ноды) 

```
### Формат конфиг файла ###

```
#!bash
(Имя ноды) (команда запуска процесса)

```
## Запуск ##

При запуске системы без указанного конфиг файла, система инициализируется из базы данных agent.db.
При запуске с конфиг файлом система инициализирутся из него и по необходимости создает базу данных.

## Работа системы ##
В базе данных есть 3 таблицы.
nodes хранит время последнего посещения для каждой из нод.
processes хранит состояния каждого из процессов
tasks хранит описание заданий, ставящихся перед нодами
Отключения нод отслеживаются.
Процессы с отключившихся нод равномерно распределяются по кластеру(То есть каждый процесс выбирает себе ноду
на которой меньше всего запущено процессов)
Так же, если процесс запускался лимитированное число раз и падал на ноде, он пытается мигрировать на другую.
При этом на старую он больше не вернется.
Для пользователя есть специальный веб интерфейс: http://ip:port/run.
Он поддерживает работу с базой данных, а так же ее просмотр.
В случае завершения процесса с кодом возрата 0, он отмечается успешным и больше не запускается.
