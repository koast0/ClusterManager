# ClusterManager
## Запуск ##

### Необходимо для запуска ###

```
#!bash

# tornado
pip3 install tornado

# requests
pip3 install requests


```



### Master: ###
```
#!bash
python3 master.py -c [--config] (файл конфига)

```
### Agent: ###
```
#!bash
python3 agent.py -ip[--address] (ip сервера) -p[--port] (порт сервера) 
-n[--name] (имя ноды) 

```
### Формат конфиг фала ###

```
#!bash
(Имя ноды) (команда запуска процесса)

```
## Работа системы в целом ##
Нода сообщает мастеру, о том, что готова выполнять задания. Мастер смотрит в своей конфигурации, какие задания он должен запустить на этой ноде. Он передает ноде
информацию о том, что последняя должна делать. Нода пытается запустить процессы,
информацию о которых получила от мастера. В случае остановки какого-то процесса
нода его перезапускает 
и извещает об этом мастера. Если нода перезапустила процесс слишком много раз,
она бросает это дело, и так же говорит об этом мастеру. 
Так же нода регулярно отчитыается перед мастером о том, что она еще 
жива. На мастере хранится время последнего отчета ноды. 

## Обмен данными между мастером и нодой ##

Формат всех запросов json.

Каждый запрос от ноды содержит 2 обязательных поля:
-name (Имя самой ноды)
-status (Некоторый формат запроса)

Есть 4 возможных варианта status:
1) READY
2) OK
3) FAIL
4) UNABLE_TO_LAUNCH

Первый и второй - запросы, ответы на которые слушает нода. Происходят раз в определенный период 
времени.

Третий и четвертый - запросы, порожденные нодой, если процесс остановился. Различие в том, что если 
ответ FAIL то нода продолжает пытаться запустить его.
Если ответ UNABLE_TO_LAUNCH то значит, что лимит запусков исчерпан и нода больше не будет пытаться его
запустить.

Формат ответа сервера на запросы 1 и 2 - поле action, которое принимает значения "exec" и "wait".
Если action принимает значение "exec", то в ответе есть еще одно поле task,
которое описывает процессы, которые нужно запустить, а так же uuid4 идентификатор каждого процесса.